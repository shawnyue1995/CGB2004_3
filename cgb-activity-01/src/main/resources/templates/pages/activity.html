<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container">
    <h2>活动列表页面</h2>
</div>
<div class="container">
    <button class="btn btn-primary" type="button">创建活动</button>
    <table class="table">
        <thead>
        <tr>
            <th><input type="checkbox">全选</th>
            <th>名称</th>
            <th>开始时间</th>
            <th>结束时间</th>
            <th>状态</th>
            <th colspan="2">操作</th>
        </tr>
        </thead>
        <tbody id="tbodyId">
        <tr>
            <td colspan="6"> 数据正在加载中。。。。。。</td>
        </tr>
        </tbody>
    </table>
</div>
<script src="/jquery/jquery.min.js" type="text/javascript"></script>
<script src="/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        doGetActivitys();
    })

    //基于ajax技术向服务端发异步请求获取数据，然后更新的页面上。
    function doGetActivitys() {
        //1.定义url
        var url = "doFindActivitys";
        //2.定义请求参数
        //3.发送异步ajax请求，处理响应结果
        //Jquery中Get函数应用
        //向服务端发送Get请求，并将服务端返回的json格式字符串转换为json格式的js对象
        $.get(url, function (result) {//处理服务端响应的结果
            //获取tbody对象
            var tBody = $("#tbodyId");
            //清空tbody中内容
            tBody.empty();
            //迭代result对象，并将result内容追加到tbody中
            result.forEach(item => tBody.append(doCreateRow(item)));
        }, "json")
    }

    function doCreateRow(item) {
        return `<tr>
	           <td><input type='checkbox' value=${item.id}></td>
	           <td>${item.title}</td>
	           <td>${item.startTime}</td>
	           <td>${item.endTime}</td>
	           <td>${item.state == 1 ? '有效' : '无效'}</td>
	           <td><button class='btn btn-warning btn-sm' onclick='doDeleteById(${item.id})'>delete</td>
	         </tr>`;
    }

    function doDeleteById(id) {
        //定义url
        var url = "doDeleteById"
        //定义参数
        var params = `id=${id}`;
        //发送异步请求执行删除操作
        //基于jquery中post函数发送异步请求
        $.post(url, params, function (result) {
            alert(result);
            doGetActivitys();
        })
    }
</script>


</body>
</html>